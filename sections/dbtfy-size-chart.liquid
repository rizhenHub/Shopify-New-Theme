{%- if content_for_header contains 'debutify' and settings.dbtfy_size_chart -%}
  <div class="dbtfy dbtfy-size_chart" data-section-id="{{ section.id }}">
    {%- for block in section.blocks -%}
      <div class="sc-container sc-{{ block.id }}"
           data-visibility-type="{{ block.settings.visibility }}"
           data-product="{{ block.settings.dbtfy_size_chart_product.id }}"
           data-product-collection="{{ collections[block.settings.dbtfy_size_chart_collection].handle }}"
           data-product-types="{{ block.settings.dbtfy_size_chart_type }}"
           data-product-tags="{{ block.settings.dbtfy_size_chart_tag }}"
           {{ block.shopify_attributes }}>

        <div class="sc-link spacer-bottom" hidden>
          {%- if section.settings.dbtfy_size_chart_title != blank -%}
            <button type="button" data-modal-open="#sizeChart-{{ block.id }}">
              {%- if section.settings.dbtfy_size_chart_icon != blank -%}
                <span class="{{ settings.icon }} icon-width sc-icon">{{ section.settings.dbtfy_size_chart_icon }}</span>
              {% endif %}

              {{ section.settings.dbtfy_size_chart_title }}
            </button>
          {%- endif -%}
        </div>

        <div id="sizeChart-{{ block.id }}"
            class="modal stacked-on-top-of-content sc-info sc-{{ block.id }}"
            role="dialog">

          <div class="modal-dialog modal-{{ section.settings.dbtfy_size_chart_width }}">
            <div class="modal-content overlay-content" aria-hidden="true" tabindex="-1">
              {%- if block.settings.dbtfy_size_chart_popup_title != blank -%}
                <div class="modal-header">
                  <h4 class="modal-title">
                    {%- if section.settings.dbtfy_size_chart_icon != blank -%}
                      <span class="{{ settings.icon }} icon-width sc-icon">{{ section.settings.dbtfy_size_chart_icon }}</span>
                    {% endif %}

                    {{ block.settings.dbtfy_size_chart_popup_title }}
                  </h4>

                  <button type="button"
                          class="modal-close btn btn-square-small"
                          title="{{ 'general.password_page.close' | t }}"
                          aria-label="{{ 'general.password_page.close' | t }}"
                          data-modal-close="#sizeChart-{{ block.id }}">
                    <span class="{{ settings.icon }}">close</span>
                  </button>
                </div>
              {%- endif -%}

              <div class="modal-body">
                {%- if block.settings.dbtfy_size_chart_abovetext != blank -%}
                  <div class="text-center">{{ block.settings.dbtfy_size_chart_abovetext }}</div>
                {% endif %}

                {%- if block.settings.dbtfy_size_chart_html != blank -%}
                  <div class="rte spacer-bottom-none">
                    <div>{{ block.settings.dbtfy_size_chart_html }}</div>
                  </div>
                {% endif %}

                {%- if block.settings.dbtfy_size_chart_image -%}
                  <div class="spacer-top">
                    <div class="media-wrapper" style="padding-top: {{ 1 | divided_by: block.settings.dbtfy_size_chart_image.aspect_ratio | times: 100 }}%;">
                      <img class="media lazyload"
                      {%- render 'lazysizes', img: block.settings.dbtfy_size_chart_image, img_type: 'responsive' -%}
                      alt="{{ block.settings.dbtfy_size_chart_image.alt }}">
                    </div>
                  </div>
                {%- endif -%}

                {%- if block.settings.dbtfy_size_chart_undertext != blank -%}
                  <div class="text-center spacer-top">{{ block.settings.dbtfy_size_chart_undertext }}</div>
                {%- endif -%}
              </div>
            </div>
          </div>
        </div>

        <div class="overlay-modal overlay-backdrop"></div>
      </div>
    {%- endfor -%}
  </div>
{%- endif -%}

{% schema %}
  {
    "name": "t:sections.dbtfy_size_chart.name",
    "settings": [
      {
        "type": "header",
        "content": "t:sections.dbtfy_size_chart.settings.header__1.content"
      },
      {
        "type": "paragraph",
        "content": "t:sections.dbtfy_size_chart.settings.paragraph__1.content"
      },
      {
        "type": "paragraph",
        "content": "t:sections.dbtfy_size_chart.settings.paragraph__2.content"
      },
      {
        "type": "header",
        "content": "t:sections.dbtfy_size_chart.settings.header__2.content"
      },
      {
        "type": "text",
        "id": "dbtfy_size_chart_icon",
        "label": "t:sections.dbtfy_size_chart.settings.icon.label",
        "default": "straighten",
        "info": "t:sections.dbtfy_size_chart.settings.icon.info"
      },
      {
        "type": "text",
        "id": "dbtfy_size_chart_title",
        "label": "t:sections.dbtfy_size_chart.settings.button_label.label",
        "default": "Size chart"
      },
      {
        "type": "select",
        "id": "dbtfy_size_chart_width",
        "label": "t:sections.dbtfy_size_chart.settings.popup_width.label",
        "default": "large",
        "options": [
          {
            "value": "small",
            "label": "t:sections.dbtfy_size_chart.settings.popup_width.options__1.label"
          },
          {
            "value": "medium",
            "label": "t:sections.dbtfy_size_chart.settings.popup_width.options__2.label"
          },
          {
            "value": "large",
            "label": "t:sections.dbtfy_size_chart.settings.popup_width.options__3.label"
          },
          {
            "value": "xlarge",
            "label": "t:sections.dbtfy_size_chart.settings.popup_width.options__4.label"
          }
        ]
      }
    ],
    "blocks" : [
      {
        "type": "text",
        "name": "t:sections.dbtfy_size_chart.blocks.text.name",
        "settings": [
          {
            "type": "text",
            "id": "title",
            "label": "t:sections.dbtfy_size_chart.blocks.text.settings.block_name.label",
            "info": "t:sections.dbtfy_size_chart.blocks.text.settings.block_name.info"
          },
          {
            "type": "text",
            "id": "dbtfy_size_chart_popup_title",
            "label": "t:sections.dbtfy_size_chart.blocks.text.settings.title.label",
            "default": "Size guide"
          },
          {
            "type": "richtext",
            "id": "dbtfy_size_chart_abovetext",
            "label": "t:sections.dbtfy_size_chart.blocks.text.settings.above_text.label"
          },
          {
            "type": "html",
            "id": "dbtfy_size_chart_html",
            "label": "t:sections.dbtfy_size_chart.blocks.text.settings.html_code.label",
            "default": "<table><thead><tr><td>Mens</td><td>Small</td><td>Medium</td><td>Large</td><td>X-Large</td><td>XX-Large</td></tr></thead><tbody><tr><td>Neck</td><td>14-14.5</td><td>15-15.5</td><td>16-16.5</td><td>17-17.5</td><td>18-18.5</td></tr><tr><td>Chest</td><td>35-37</td><td>38-40</td><td>41-43</td><td>44-46</td><td>47-49</td></tr><tr><td>Sleeve</td><td>32-33</td><td>33-34</td><td>34-35</td><td>35-36</td><td>36-36.5</td></tr><tr><td>Waist</td><td>29-31</td><td>32-34</td><td>35-37</td><td>38-40</td><td>41-43</td></tr></tbody></table>",
            "info": "t:sections.dbtfy_size_chart.blocks.text.settings.html_code.info"
          },
          {
            "type": "image_picker",
            "id": "dbtfy_size_chart_image",
            "label": "t:sections.dbtfy_size_chart.blocks.text.settings.image.label"
          },
          {
            "type": "richtext",
            "id": "dbtfy_size_chart_undertext",
            "label": "t:sections.dbtfy_size_chart.blocks.text.settings.below_text.label"
          },
          {
            "type": "header",
            "content": "t:sections.dbtfy_size_chart.blocks.text.settings.header__1.content",
            "info": "t:sections.dbtfy_size_chart.blocks.text.settings.header__1.info"
          },
          {
            "type": "radio",
            "id": "visibility",
            "label": "t:sections.dbtfy_size_chart.blocks.text.settings.visibility.label",
            "info": "t:sections.dbtfy_size_chart.blocks.text.settings.visibility.info",
            "default": "all",
            "options": [
              {
                "value": "all",
                "label": "t:sections.dbtfy_size_chart.blocks.text.settings.visibility.options__1.label"
              },
              {
                "value": "collection",
                "label": "t:sections.dbtfy_size_chart.blocks.text.settings.visibility.options__2.label"
              },
              {
                "value": "type",
                "label": "t:sections.dbtfy_size_chart.blocks.text.settings.visibility.options__3.label"
              },
              {
                "value": "tag",
                "label": "t:sections.dbtfy_size_chart.blocks.text.settings.visibility.options__4.label"
              },
              {
                "value": "product",
                "label": "t:sections.dbtfy_size_chart.blocks.text.settings.visibility.options__5.label"
              }
            ]
          },
          {
            "type": "collection",
            "id": "dbtfy_size_chart_collection",
            "label": "t:sections.dbtfy_size_chart.blocks.text.settings.collection.label"
          },
          {
            "type": "textarea",
            "id": "dbtfy_size_chart_type",
            "label": "t:sections.dbtfy_size_chart.blocks.text.settings.product_types.label",
            "info": "t:sections.dbtfy_size_chart.blocks.text.settings.product_types.info"
          },
          {
            "type": "textarea",
            "id": "dbtfy_size_chart_tag",
            "label": "t:sections.dbtfy_size_chart.blocks.text.settings.product_tags.label",
            "info": "t:sections.dbtfy_size_chart.blocks.text.settings.product_tags.info"
          },
          {
            "type": "product",
            "id": "dbtfy_size_chart_product",
            "label": "t:sections.dbtfy_size_chart.blocks.text.settings.product.label"
          }
        ]
      }
    ]
  }
{% endschema %}
